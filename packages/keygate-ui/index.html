<html>
  <body>
    <script type="module">
      const allowedOrigins = ["http://127.0.0.1:5500"];

      addEventListener("message", (e) => {
        if (!allowedOrigins.includes(e.origin)) return;
        if (!e.data.data || !e.data.id) return;
        const { id, data } = e.data;

        if (data === "ping") {
          window.parent.postMessage({ id, data: "pong" }, e.origin);
        }

        if (data === "refreshAccessToken") {
          window.parent.postMessage({ id, data: "ping" }, e.origin);
        }

        e.source.window.postMessage({ id, error: "unknown method" }, e.origin);
      });
    </script>
  </body>
</html>
